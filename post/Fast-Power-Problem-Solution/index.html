<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>【洛谷P1226】【模板】快速幂||取余运算 题解 | SkinCrab</title>
<script data-ad-client="ca-pub-5872449510033483" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://skina.cn/favicon.ico?v=1586412818220">
<link rel="stylesheet" href="https://skina.cn/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162409810-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162409810-1');
</script>


    <meta name="description" content="拿到题目，看了下内容，发现这道题可以运用到二分算法。
也就是说可以将p拆解，举个栗子3^90%17
3^90 % 17可以拆分为 ((3^45 % 17)*(3^45 % 17)) % 17
而3^45 % 17则又可以拆分为((3^22 ..." />
    <meta name="keywords" content="题解,洛谷" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://skina.cn">
        <img src="https://skina.cn/images/avatar.png?v=1586412818220" class="site-logo">
        <h1 class="site-title">SkinCrab</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
        
          <a href="https://skina.cn/post/Items" class="site-nav">
            项目
          </a>
        
      
        
          <a href="https://skina.cn/post/links" class="site-nav">
            朋友们
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://www.github.com/skincrab" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      无人能懂我的欢乐
    </div>
    <div class="site-footer">
      Powered by<a href="https://github.com/skincrab" target="_blank">SkinCrab</a> | <a class="rss" href="https://skina.cn/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">【洛谷P1226】【模板】快速幂||取余运算 题解</h2>
            <div class="post-date">2020-04-09</div>
            
            <div class="post-content" v-pre>
              <p>拿到题目，看了下内容，发现这道题可以运用到二分算法。</p>
<p>也就是说可以将p拆解，举个栗子3^90%17</p>
<pre><code>3^90 % 17可以拆分为 ((3^45 % 17)*(3^45 % 17)) % 17
而3^45 % 17则又可以拆分为((3^22 % 17)*(3^22 % 17)*(3 % 17)) % 17
后3^22 % 17则拆分为((3^11 % 17)*(3^11 %17)) % 17
</code></pre>
<p>以此类推可得</p>
<pre><code>3^11 % 17 = ((3^5 % 17)*(3^5 %17)*(3 %17)) % 17
3^5 % 17 = ((3^2 % 17)*(3^2 % 17)*(3 % 17)) % 17
3^2 % 17= ((3 % 17)*(3 % 17)) % 17
</code></pre>
<p>因此可得如下p的变化<br>
<img src="https://skina.cn/post-images/1586412605583.png" alt="p的变化" loading="lazy"></p>
<p>为了提升速度，我们据上表，可知只需计算上表绿色部分，即3^&quot;绿色部分&quot; % 17，得代码如下</p>
<pre><code class="language-c++">long long cal(long long b,long long p,long long k) {
    if(p==1) return b%k;
    return ( cal( b , p/2 , k )%k * cal( b , p/2 , k )%k )%k;
}
</code></pre>
<p>但是以上代码只能处理p为偶数的情况<br>
因此需在return处添加<code>( p%2==0 ? 1 : b%k )</code><br>
即当p为偶数时返回1，否则返回b%k</p>
<p>可是cal函数被调用了两次，是否可以进行优化呢？</p>
<pre><code class="language-c++">long long cal(long long b,long long p,long long k) {
    if(p==1) return b%k;
    int t=cal( b , p/2 , k )%k;
    return ( t * t * ( p%2==0 ? 1 : b%k ))%k;
}
</code></pre>
<p>以上为本程序的精华部分，输入输出就不必讲了，以下为我的代码。</p>
<pre><code class="language-c++"># include &lt;iostream&gt;
# include &lt;cstdio&gt;
using namespace std;
long long b,p,k;
long long cal(long long b,long long p,long long k) {
    if(p==1) return b%k;
    int t=cal( b , p/2 , k )%k;
    return ( t * t *( p%2==0 ? 1 : b%k ))%k;
}
int main() {
    cin&gt;&gt;b&gt;&gt;p&gt;&gt;k;
    printf(&quot;%d^%d mod %d=%d&quot;,b,p,k,cal( b , p , k ));
    return 0;
}
</code></pre>
<p>当然，当p=0时，这个程序无法完美解决，需要你们自己动点手脚噢！</p>
<p>以上内容摘自<a href="https://skincrab.blog.luogu.org/solution-p1226">我的洛谷博客</a><br>
转载请务必注明链接。</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://skina.cn/tag/prFRuuXDN/" class="tag">
                    题解
                  </a>
                
                  <a href="https://skina.cn/tag/PRKIWGzFzP/" class="tag">
                    洛谷
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://skina.cn/post/tencent-bot/">
                  <h3 class="post-title">
                    腾讯官方机器人“HOO!K”
                  </h3>
                </a>
              </div>
            

            

			<div id="vcomments"></div>
			<script>
				new Valine({
					el: '#vcomments',
					appId: '6H4OQzIlcbW9l8MgmcqOFixI-gzGzoHsz',
					appKey: '9x36v2N723mtlEYjT8CaaSjn'
				})
			</script>
          </div>

        </div>
      </div>
    </div>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
